<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Computational Reproducibility: Dependencies</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KSGZ4ESKQ3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  
  gtag('config', 'G-KSGZ4ESKQ3');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">RDM Jumpstart</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 1
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="1-Overview.html">Overview</a>
    </li>
    <li>
      <a href="introduction.html">Introduction to the RDM Jumpstart</a>
    </li>
    <li>
      <a href="1-LEC-1-ImportanceRDM.html">RDM: Introduction</a>
    </li>
    <li>
      <a href="1-LEC-2-DataScience.html">Workflow for the Week</a>
    </li>
    <li>
      <a href="1-LEC-3-OSF.html">OSF</a>
    </li>
    <li>
      <a href="1-LEC-4-DMPs.html">Data Management Plans</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 2
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="2-Overview.html">Overview</a>
    </li>
    <li>
      <a href="2-LEC-1-BiasRepro.html">RDM: Bias &amp; Reproducibility</a>
    </li>
    <li>
      <a href="2-LEC-3-GUIscript.html">Computational Reproducibility: Excel vs R</a>
    </li>
    <li>
      <a href="2-ACT-1-RSetup.html">R: Setting Up</a>
    </li>
    <li>
      <a href="2-ACT-2-FirstSteps.html">R: First Steps</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 3
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="3-Overview.html">Overview</a>
    </li>
    <li>
      <a href="3-LEC-2-Dependencies.html">Computational Reproducibility: Dependencies</a>
    </li>
    <li>
      <a href="3-ACT-2-DataTypesStructures.html">R: Data Types and Structures</a>
    </li>
    <li>
      <a href="3-ACT-3-FilterSelect.html">R: Filter and Select</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 4
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="4-Overview.html">Overview</a>
    </li>
    <li>
      <a href="4-ACT-2-DataVisualization.html">R: Data Visualization</a>
    </li>
    <li>
      <a href="4-ACT-1-Troubleshooting.html">R: Troubleshooting</a>
    </li>
    <li>
      <a href="4-ACT-3-SavingOutput.html">R: Saving Output</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 5
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="5-Overview.html">Overview</a>
    </li>
    <li>
      <a href="5-LEC-1-ShareDeposit.html">Day 5 - Sharing &amp; Depositing</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Extras
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Resources</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="codeOfConduct.html">Code of Conduct</a>
        </li>
        <li>
          <a href="6-EXT-ProjectDMP.html">Project DMP</a>
        </li>
        <li>
          <a href="6-EXT-RCheatsheet.html">R Cheatsheet</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Roadmaps</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="6-EXT-RDMRoadmap.html">RDM Roadmap</a>
        </li>
        <li>
          <a href="6-EXT-CRRoadmap.html">Reproducible Roadmap</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Additional Content</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="6-EXT-osfR.html">osfr</a>
        </li>
        <li>
          <a href="6-EXT-dd.html">Creating a data dictionary</a>
        </li>
        <li>
          <a href="6-EXT-dirsFiles.html">Directories and files</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Setup</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="6-EXT-RRStudio.html">R &amp; RStudio Setup</a>
        </li>
        <li>
          <a href="6-EXT-osfSetup.html">OSF Setup</a>
        </li>
        <li>
          <a href="6-EXT-Borealis.html">Borealis Setup</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="contributors.html">Contributors</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Computational Reproducibility:
Dependencies</h1>

</div>


<div class="intro">
<p>Managing external dependencies is critical to ensuring that you can
maintain computational reproducibility when you move your code to a new
computer.</p>
</div>
<div id="dependencies" class="section level2">
<h2>Dependencies</h2>
<blockquote>
<p>If you wish to make an apple pie from scratch, you must first invent
the universe</p>
</blockquote>
<p>– Carl Sagan</p>
<p>Dependencies are essentially prerequisites – the things you need to
complete a task. For example, so far, we require both R and some of the
packages in <code>TidyVerse</code> to run the code we’ve written.
Dependencies – and tracking dependencies – are a significant issue in
computationally reproducible research.</p>
<p>Part of good research data management when using a scripting language
is finding ways of tracking and documenting dependencies. At it’s
simplest, this means recording somewhere:</p>
<ul>
<li>your operating system and version</li>
<li>your scripting language and version</li>
<li>your extra packages or libraries and their versions.</li>
</ul>
<p>This information provides a framework for creating a computationally
reproducible environment. But even this documented framework can be
insufficient.</p>
</div>
<div id="environments" class="section level2">
<h2>Environments</h2>
<p>We can break addressing dependencies down into three distinct
categories, levels, or environments that need to be addressed:</p>
<ul>
<li>Keeping a stable R environment</li>
<li>Maintaining relationships to external programs</li>
<li>Keeping a stable operating system environment</li>
</ul>
<div id="stable-r-environment" class="section level3">
<h3>Stable R Environment</h3>
<p>We’ve talked about base R and about extending it with additional
packages or libraries. It is very possible that an updated package or an
updated version of R could break your code.</p>
<p>Base R packages are generally quite robust to backwards
compatibility, but not always. A few examples:</p>
<ul>
<li>When R 3.6 was released, <a
href="https://github.com/workflowr/workflowr/issues/215">an update to
<code>set.seed()</code></a> that is used for reproducible results when
random number generation is needed – i.e. you need to take a random
sample from your dataset – broke several packages that relied on
<code>set.seed()</code>.</li>
<li>Similarly, when R 4.0 was released, <a
href="https://journal.r-project.org/archive/2020-2/core.pdf">updates to
the matrix object</a> had its class changed from <code>array</code> to
<code>c("matrix", "array")</code> breaking any packages that relied on
testing the class of this data structure using
<code>class()</code>.</li>
<li>Finally, and this will be covered in more detail in the next lesson,
but we will be working with factor data, so another, potentially more
relatable example is the change made with the update to R 4.0 to not
have characters translated to factors by default on import. This change
risked breaking a lot of code. <a
href="https://datacolada.org/95#footnote_0_5852">See this example from
Uri Simonsohn with Data Colada</a>:</li>
</ul>
<p><img src="images/day2_dependencies.png" /></p>
<p>This kind of break is much more common with external packages. Even
when these packages have robust compatability standards, like with
TidyVerse – <a
href="https://www.TidyVerse.org/blog/2019/04/r-version-support/">you can
read about their versoin support here</a>. Later, we’ll be using the
<code>distinct()</code> function from the <code>dplyr</code> package
that is part of the TidyVerse. A 2016 update to the function changed its
default behaviour effectively reducing the number of variables preserved
by the function. Running a script written with the earlier version of
<code>distinct()</code> could well break under a later version of the
same function.</p>
<p>This kind of change that comes with an update is common enough to be
a significant issue. The above Data Colada article provides a few more
examples and links to others.</p>
<p>More importantly, this may not happen just on your machine. We want
to make sure that your code is transferable to another person’s computer
and will still run irrespective of how they have set up their R
environment. We’ll explore one solution to this in R, but will first
look at what happens to external R packages that can cause issues when
code is moved to another computer.</p>
</div>
<div id="external-programs" class="section level3">
<h3>External programs</h3>
<p>Some R functions and packages are reliant on external programs. The
<code>knitr</code> package that allows RMarkdown documents to be
converted between document types (producing html, pdf, etc documents),
and that we are using in this workshop, is a good example of this.
Depending on what document type you’re exporting your .Rmd file to,
<code>knitr</code> relies on external programs such as <a
href="https://pandoc.org/">Pandoc</a> and <a
href="https://www.latex-project.org/">LaTeX</a>. Considering this, it
can be challenging to ensure that over time and across systems your .Rmd
files will in fact output in the way that you expect. In this instance,
this doesn’t nullify your code, just the conversion process from .Rmd to
.html or .pdf.</p>
<p>Another example is being able to read Excel files into R. And this
will lead us into the next consideration of keeping a stable system.</p>
<p>There is more than one package available in R to load in Excel files.
One, <code>xlsx</code> requires that Java, another programming language,
be installed on the user’s machine. Not everyone has Java, or the right
version of Java, installed on their machines. Because of this,
<code>xlsx</code> is very prone to breaking code across machines. A
second is <code>readxl</code> from the TidyVerse. <code>readxl</code>
uses two libraries whose licensing allows for redistribution with
someone else’s code, so, <code>readxl</code> includes and installs these
libraries when the <code>readxl</code> package is installed. It is much
more robust when moved across computers and operating systems.</p>
<p>Maintaining relationships to external programs is very challenging.
If using packages external to base R and the TidyVerse, you should read
about these packages first and learn about their dependencies and use
them only if they work with your needs as they relate to
reproducibility, and, as necessary, maintain robust documentation about
them.</p>
<ul>
<li><a
href="https://cran.r-project.org/web/packages/xlsx/index.html"><code>xlsx</code>
documentation page</a></li>
<li><a
href="https://cran.r-project.org/web/packages/readxl/index.html"><code>readxl</code>
documentation page</a></li>
</ul>
</div>
<div id="keeping-a-stable-system" class="section level3">
<h3>Keeping a Stable System</h3>
<p>We mentioned above that <code>readxl</code> uses two external
libraries – this is very common in computer programs – if one person has
solved a problem, i.e. how to read in proprietary Excel files into
another application, and is willing to share that solution, no one else
needs to solve that same problem.</p>
<p>However, for a variety of reasons, not all ‘shared’ libraries, as
these are referred to, are bundled the way they are in
<code>readxl</code>. In these instances, these libraries usually sit
somewhere else that is globally accessible to any application on your
computer. The only way to resolve this kind of dependency is to make a
copy of your entire operating system that includes any external programs
and your R environment.</p>
<p>This is far more than we cover here, but a popular option to
facilitate creating a copy of your complete computing environment is
using an application called Docker.</p>
</div>
<div id="overall-considerations" class="section level3">
<h3>Overall Considerations</h3>
<p>Consider what your specific needs are before venturing down these
routes. A small project written in only base R likely needs only to
record the version of R it is using. A project that uses only
self-contained external R packages only needs <code>renv</code> – see
below. A project that has external program dependencies may suffice to
simply document what these dependencies are and what needs to be
installed to resolve them. It is only in large, complex projects, and
one’s where a risk assessment determines that computational
reproducibility is critical, that you would consider resorting to a
solution like Docker.</p>
</div>
</div>
<div id="a-reproducible-r-environment" class="section level2">
<h2>A Reproducible R Environment</h2>
<p>How to resolve the R dependency problem? A popular option is with the
<code>renv</code> package.</p>
<p>Before we begin, it’s important to draw a distinction here between a
package and a library in R. A package is a set of functions and data.
We’ve seen many of the functions included in the <code>TidyVerse</code>
set of packages. A library is a place where these packages are stored on
your computer. You can see where your packages are stored with
<code>.libPaths()</code>.</p>
<pre class="r"><code>.libPaths()</code></pre>
<pre><code>## [1] &quot;/Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library&quot;</code></pre>
<p>Note that, by default, these are not stored with your R project. So
when you move your project folder, you don’t also move your additional
packages.</p>
<p>A simple way to handle this is to use the <code>renv</code> package,
which installs your packages in your project folder as well and
maintains detailed information about them so that should they need to be
re-installed they can be and with the exact same version. Thus, you end
up with a stable, reproducible R environment.</p>
<div id="renv-in-action" class="section level3">
<h3>renv in Action</h3>
<p>First we install, load, and initialize <code>renv</code> – this only
needs to be done once.</p>
<pre class="r"><code>install.packages(&quot;renv&quot;)
renv::init()</code></pre>
<div class="note">
<p>You’ll notice that we’re using a different way of calling the
<code>init()</code> function here, first noting the package that it’s in
<code>renv</code> followed by two colons <code>::</code>. Similarly to
how in day 2 we loaded all of TidyVerse with
<code>library(TidyVerse)</code>, but later today we’ll only load one
package from the TidyVerse, <code>dplyr</code>, to trim down how much
we’re loading into memory, we can also load only specific functions from
a package – we don’t call <code>library()</code>, we just reference the
package, and then call the function of interest.</p>
</div>
<p>The <code>init()</code> function does a couple of things. It:</p>
<ul>
<li>populates your .Rprofile with a line to be read every time you
launch your project to <code>activate()</code> <code>renv</code></li>
<li>creates a <code>renv/</code> directory where your local libraries
are installed.</li>
<li>creates a <code>renv.lock</code> file that maintains metadata about
the libraries you’re using in the project.</li>
</ul>
<p>In fact, if we run <code>.libPaths()</code> again, we’ll see the
output has changed and that there are two library paths now.</p>
<pre class="r"><code>.libPaths()</code></pre>
<pre><code>## [1] &quot;/Users/vdunbar/Library/CloudStorage/OneDrive-UBC/_tmp/bootcamp_website/rdm-jumpstart/renv/library/R-4.3/aarch64-apple-darwin20&quot;
## [2] &quot;/Users/vdunbar/Library/Caches/org.R-project.R/R/renv/sandbox/R-4.3/aarch64-apple-darwin20/ac5c2659&quot;</code></pre>
<p>Once intialized, <code>renv</code> is ready to start installing
packages locally.</p>
<p>If you already have saved .R or .Rmd files, <code>init()</code> will
attempt to locate the packages your’re using and install them
locally.</p>
<p>If you’re initializing <code>renv</code> before saving any files,
you’ll need to manually install the packages you’ll be using going
forward, even if you’ve previously installed these by this stage,
because <code>renv</code> is looking in our project folder for
packages.</p>
<p><code>renv</code> has an install function that is more verbose than
<code>install.packages()</code> from base R.</p>
<pre class="r"><code>renv::install(&quot;TidyVerse&quot;)</code></pre>
<p>Installing a package doesn’t add the details of this package to your
<code>renv.lock</code> file; this only happens when you actively call a
package in an .R or .Rmd file and instruct <code>renv</code> to make a
record of this.</p>
<p>First you load the newly installed package.</p>
<pre class="r"><code>library(TidyVerse)</code></pre>
<p>Then you take a <code>snapshot()</code>, which tells
<code>renv</code> to document the packages you’ve used in your scripts.
In our case, we only need to do this once, since we’re only using
packages that are contained within <code>TidyVerse</code>.</p>
<pre class="r"><code>renv::snapshot()</code></pre>
</div>
<div id="the-renv.lock-file" class="section level3">
<h3>The renv.lock file</h3>
<p>This is what the <code>renv.lock</code> file looks like on the
inside:</p>
<pre><code>## {
##   &quot;R&quot;: {
##     &quot;Version&quot;: &quot;4.3.1&quot;,
##     &quot;Repositories&quot;: [
##       {
##         &quot;Name&quot;: &quot;CRAN&quot;,
##         &quot;URL&quot;: &quot;https://cloud.r-project.org&quot;
##       }
##     ]
##   },
##   &quot;Packages&quot;: {
##     &quot;DBI&quot;: {
##       &quot;Package&quot;: &quot;DBI&quot;,
##       &quot;Version&quot;: &quot;1.2.3&quot;,
##       &quot;Source&quot;: &quot;Repository&quot;,
##       &quot;Title&quot;: &quot;R Database Interface&quot;,
##       &quot;Date&quot;: &quot;2024-06-02&quot;,
##       &quot;Authors@R&quot;: &quot;c( person(\&quot;R Special Interest Group on Databases (R-SIG-DB)\&quot;, role = \&quot;aut\&quot;), person(\&quot;Hadley\&quot;, \&quot;Wickham\&quot;, role = \&quot;aut\&quot;), person(\&quot;Kirill\&quot;, \&quot;Müller\&quot;, , \&quot;kirill@cynkra.com\&quot;, role = c(\&quot;aut\&quot;, \&quot;cre\&quot;), comment = c(ORCID = \&quot;0000-0002-1416-3412\&quot;)), person(\&quot;R Consortium\&quot;, role = \&quot;fnd\&quot;) )&quot;,
##       &quot;Description&quot;: &quot;A database interface definition for communication between R and relational database management systems.  All classes in this package are virtual and need to be extended by the various R/DBMS implementations.&quot;,
##       &quot;License&quot;: &quot;LGPL (&gt;= 2.1)&quot;,</code></pre>
</div>
<div id="rebuilding-your-r-environment" class="section level3">
<h3>Rebuilding Your R Environment</h3>
<p>Packages can take up a lot of space, so generally, you don’t share
your packages or library folder with others when you share your R
project. Instead, you just share a few of the <code>renv</code>
generated files, including the:</p>
<ul>
<li><code>renv.lock</code> file – the metadata about the packages
used</li>
<li><code>.Rprofile</code> file – launches <code>renv/activate.R</code>
at startup</li>
<li><code>renv/activate.R</code> file – checks the setup on startup and
will install <code>renv</code> if it’s not installed</li>
<li><code>renv/settings.json</code> file – settings for
<code>renv</code>.</li>
</ul>
<p>This set up is intended for using a version control system like Git.
We’re going to simplify things for ourselves here by only using the
<code>renv.lock</code> file when sharing. So, you can ignore the hidden
file <code>.Rprofile</code> and the <code>renv/</code> directory.</p>
<p>This does mean that any collaborators will need to install
<code>renv</code> first on the their machines – if we included the other
files, on project start-up <code>renv</code> would be installed if it
wasn’t already. Then, they run <code>renv::activate()</code>, which gets
<code>renv</code> up and running in the project, followed by
<code>renv::restore()</code>, which rebuilds your R environment on their
machine.</p>
<p>At the end of today, when we upload our data and .Rmd files to OSF,
we will now also include the <code>renv.lock</code> file. We should also
update our readme with the <code>renv</code> setup instructions.</p>
<p>Read more about the <code>renv</code> package at <a
href="https://rstudio.github.io/renv/articles/renv.html">https://rstudio.github.io/renv/articles/renv.html</a></p>
</div>
</div>

<div id="footer">
    <hr />
    <div class = "inst-logos">
      <img src="images/institutions/carleton.png" />
      <img src="images/institutions/calgary.png" />
      <img src="images/institutions/ubc.png" />
      <img class="uvic"  src="images/institutions/uvic.png" />
    </div>

<br>
    <div>
      <img class = "cc-licence" src="images/institutions/CC-License.png" />
      <p>This work is licensed under a <a href="https://creativecommons.org/licenses/by-nc/4.0/" target ="blank">Creative Commons Attribution-NonCommercial 4.0 International License</p>
</div>
<br>
Built and rendered courtesy of <a href="https://rmarkdown.rstudio.com/index.html" target ="blank">RMarkdown from RStudio</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
